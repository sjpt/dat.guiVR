<!DOCTYPE html>
<html>
  <head>
    <title>Example of extras in xinaesthete ImageButton branch</title>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, minimal-ui" name="viewport" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" type="text/css" href="style.css">
  </head>
  <body>

    <script type="text/javascript" src="https://cdn.rawgit.com/mrdoob/three.js/r82/build/three.min.js"></script>
    <script type="text/javascript" src="../build/datguivr.js"></script>


    <script type="text/javascript">

      var camera, scene, renderer, gui;
      var settings = {
        'speed':20,
        'friction':0.1
      }

      initThreeJS();
      initApp();
      animate();

      function initThreeJS() {
        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.1, 15 );
        camera.position.set(0,0,1.0);

        renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );
        document.body.appendChild( renderer.domElement );
      }
      
      function initApp(){

        const parent = new THREE.Group();
        parent.position.set(-0.5, 0, 0);
        scene.add(parent);

        gui = dat.GUIVR.create( 'Empty GUI' );
        parent.add(gui);
        gui.scale.set(0.5, 0.5, 0.5);

        const test = {myColor: new THREE.Color(0, 0.7, 0.6), color2: new THREE.Color() };
        gui.addDropdown(["abcdefg", "option 2"]).name("dropdown");
        gui.add(test, 'myColor').onChange(c=>renderer.setClearColor(c));
        gui.add(test, 'color2');

        //creating lots of stuff just to take up space and test layout.
        let f = dat.GUIVR.create("Long Folder");
        for (let i=0; i<52; i++) {
          f.add(test, 'myColor');
          if (i % 20 === 0) {
            f.addImageButton(()=>{}, "textures/branches_white.png");
          } 
        }
        gui.addFolder(f);

        f = dat.GUIVR.create("pictures / materials");
        //addImageButton currently takes a callback function followed by filename string or THREE Texture / RenderTarget / Material object
        f.addImageButton(()=>{console.log("image button pressed")}, "textures/bin.png")
        f.addImageButton(()=>{console.log("image button pressed")}, "textures/branches_white.png")
        //callback taking clicked position, third argument 'true' to use full-width.
        //interface may be liable to change on a whim at a later date to allow distinguishing between click / drag / release
        //and to change size specification.
        f.addImageButton((x, y)=>{console.log(`${x}, ${y}`)}, new THREE.MeshNormalMaterial(), true) 
        f.addImageButton(()=>{console.log("image button pressed")}, new THREE.MeshBasicMaterial(), true)
        //f.add(settings, 'speed');
        gui.addFolder(f);
        gui.add(settings, 'speed');
        
        let fn = ()=>{console.log("image button pressed")};
        
        // f = dat.GUIVR.create("Folder2");
        // f.addImageButton(()=>{console.log("image button pressed")}, "textures/butterfly_white.png")
        // f.addImageButton(()=>{console.log("image button pressed")}, "textures/mag_white.png")
        // gui.addFolder(f);
        let i = 0;
        let t = ()=> {return `tip ${i++}`};

        f = gui.addImageButtonPanel(
          {func: fn, image: "textures/butterfly_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/butterfly_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/butterfly_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/mag_white.png", tip: t() }
          , {func: fn, image: "textures/butterfly_white.png", tip: "mmmmmmmm" }
          , {func: fn, image: "textures/mag_white.png",       tip: "........" }
          , {func: fn, image: "textures/mag_white.png", tip: "rather a long tip..." }
        ).highlightLastPressed();

        gui.addTextbox({t: 'hello world'}, 't');
        
        gui.addKeyboard();
        
        dat.GUIVR.enableMouse( camera );
      }


      function animate() {

        renderer.render( scene, camera );

        requestAnimationFrame( animate );
      }
    </script>
  </body>
</html>